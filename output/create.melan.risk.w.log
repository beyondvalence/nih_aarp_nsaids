2088  /******************************************************************
2089  #      NIH-AARP UVR- NSAIDs- Melanoma Study
2090  *******************************************************************
2091  #
2092  # creates the melanoma file with cancer, smoking,
2093  # NSAID, UVR variables
2094  # !!!!! for risk factors dataset !!!!!
2095  #
2096  # uses the uv_public, rout25mar16, rexp23feb16 datasets
2097  # note: using new rexp dataset above
2098  #
2099  # Created: April 13 2015
2100  # Updated: v20160421THU WTL
2101  # Under git version control
2102  # Used IMS: anchovy server
2103  # Warning: original IMS datasets are in LINUX latin1 encoding
2104  *******************************************************************/
2105
2106  options nocenter yearcutoff=1900 errors=1;
2107  title1 'NIH-AARP NSAIDs UVR Melanoma Study';
2108
2109  libname conv 'C:\REB\NSAIDS melanoma AARP\Data\converted';
NOTE: Libref CONV was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\REB\NSAIDS melanoma AARP\Data\converted
2110  libname anchovy 'C:\REB\NSAIDS melanoma AARP\Data\anchovy';
NOTE: Libref ANCHOVY was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\REB\NSAIDS melanoma AARP\Data\anchovy
2111  filename uv_pub 'C:\REB\NSAIDS melanoma AARP\Data\anchovy\uv_public.v9x';
2112
2113  ** import the UVR with file extension v9x from the anchovy folder;
2114  proc cimport data=uv_pub1 infile=uv_pub;
2115  run;

NOTE: PROC CIMPORT begins to create/update data set WORK.uv_pub1
NOTE: Data set contains 38 variables and 566398 observations.
      Logical record length is 304

NOTE: PROCEDURE CIMPORT used (Total process time):
      real time           1.42 seconds
      cpu time            1.40 seconds


2116
2117  ** keep the july 1978-2005 UVR data only;
2118  data conv.uv_pub1;
2119      set uv_pub1;
2120      keep    westatid
2121              exposure_jul_78_05;
2122  run;

NOTE: There were 566398 observations read from the data set WORK.UV_PUB1.
NOTE: The data set CONV.UV_PUB1 has 566398 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.12 seconds
      cpu time            0.10 seconds


2123
2124  ** input: first primary cancer _risk;
2125  ** output: ranalysis;
2126  ** uses rout25mar16, rexp23feb16, uv_pub1;
2127  ** riskfactor dataset;
2128
2129  data ranalysis;
2130    *merge conv.rout09jan14 (in=ino) conv.rexp16feb15 (in=ine);
2131    merge anchovy.rout25mar16 (in=ino) anchovy.rexp23feb16 (in=ine);
NOTE: Data file ANCHOVY.ROUT25MAR16.DATA is in a format that is native to another host, or the file
      encoding does not match the session encoding. Cross Environment Data Access will be used, which
      might require additional CPU resources and might reduce performance.
NOTE: Data file ANCHOVY.REXP23FEB16.DATA is in a format that is native to another host, or the file
      encoding does not match the session encoding. Cross Environment Data Access will be used, which
      might require additional CPU resources and might reduce performance.
2132    by westatid;
2133      keep    westatid
2134              rf_entry_dt
2135              rf_entry_age
2136              entry_dt
2137              f_dob
2138              racem /* for race exclusions */
2139              SEX
2140              raadate /* date moved outside of Registry Ascertainment Area */
2141              entry_age
2142              entry_dt
2143              cancer
2144              cancer_dxdt
2145              cancer_seergroup
2146              cancer_behv /* for cancer staging */
2147              cancer_siterec3
2148
2149              self_other /* required for excl macro, for self reported cancers */
2150
2151              health /* required for excl macro */
2152              DOD /* date of death */
2153              EDUCM
2154              fl_proxy /* for proxy responder exclusions */
2155
2156              /* smoking */
2157              smoke_former
2158              smoke_quit
2159              smoke_dose
2160              smoke_quit_dose
2161
2162              BF_COMB_SELF_CANCER
2163              BF_HORMEVER
2164              BF_HORMTYPE
2165              BF_SMOKE_EVER
2166              BF_SMOKE_FORMER
2167
2168              rel_1d_cancer           /* family history of cancer - any 1st degree relatives ever
2168! diagnosed with cancer (nnmsc)*/
2169              /*FAM_CANCER                 Any blood relatives diagnosed with cancer?*/
2170
2171          /******** riskfactor characteristics variables ********/
2172              rf_agecat
2173              rf_1d_cancer
2174
2175              /* necessary for exclusions */
2176              fl_rf_proxy
2177              rf_q23_2_1a
2178              rf_q23_2_2a
2179
2180              /* add more variables here */
2181              rf_Q44                  /* mammogram */
2182              rf_Q15A                 /* colonoscopy */
2183              rf_Q15B
2184              rf_Q15C
2185              rf_Q15D
2186              rf_Q15E
2187              HEART                   /* baseline Q40C */
2188              DIABETES                /* baseline Q40B self-report diabetes y/n */
2189              MARRIAGE
2190              BMI_CUR                 /* current bmi kg/m2*/
2191              qp12b                   /* coffee drinking */
2192              physic                  /* physical activity >=20 min in past 12 months */
2193              physic_1518             /* physical activity >=20 min in past 12 months during ages
2193! 15-18 */
2194              mped_a_bev              /* total alcohol per day including food sources */
2195              q29c                    /* single supplement: selenium */
2196              q30b1                   /* how often: beta-carotene */
2197              q30b2                   /* amount: beta-carotene */
2198              q30d1                   /* how often: vitamin e */
2199              q30d2                   /* amount: vitamin e */
2200              rf_Q47_1                /* Ever been told by doctor to have hypertension */
2201              rf_Q48                  /* have you had a physically demanding job? */
2202              rf_Q49                  /* how many physically demanding jobs have you ever held? */
2203              rf_Q50                  /* what is the total number of years that you worked in
2203! physically demanding jobs? */
2204              rf_Q51_1                /* have you had a job where you walked or biked most days of
2204! the week? */
2205              rf_Q51_2                /* total number of years that you walked or biked to work most
2205! days of the week */
2206              rf_Q52                  /* in a typical 24 hr period, how often do you watch TV or
2206! movies in the past 12mo */
2207              rf_Q53_B                /* number of hours spent napping per day */
2208              rf_Q53_C                /* number of hours spent sitting per day */
2209              rf_Q54_1                /* hours of light activity ages 15-18 */
2210              rf_Q54_2                /* hours of light activity ages 19-29 */
2211              rf_Q54_3                /* hours of light activity ages 30-39 */
2212              rf_Q54_4                /* hours of light activity past 10 years */
2213              rf_Q55_1                /* hours of moderate to vigorous activity ages 15-18 */
2214              rf_Q55_2                /* hours of moderate to vigorous activity ages 19-29 */
2215              rf_Q55_3                /* hours of moderate to vigorous activity ages 30-39 */
2216              rf_Q55_4                /* hours of moderate to vigorous activity past 10 years*/
2217
2218              RF_PHYS_MODVIG_15_18    /*How often did you participate in moderate to vigorous
2218! activities between the ages of 15 & 18?*/
2219              RF_PHYS_MODVIG_19_29    /*How often did you participate in moderate to vigorous
2219! activities between the ages of 19 & 29?*/
2220              RF_PHYS_MODVIG_35_39    /*How often did you participate in moderate to vigorous
2220! activities between the ages of 35 & 39?*/
2221              RF_PHYS_MODVIG_CURR     /*How often did you participate in moderate to vigorous
2221! activities in the past 10 years?*/
2222              RF_PHYS_JOB             /*Number of physically demanding jobs (0=None, 1=1-2, 2=3-5,
2222! 3=6+, 9=Unk)*/
2223              RF_PHYS_JOBYRS          /*Number of years with a physically demanding job (0=<1, 1=1-2,
2223!  2=3-5, 3=6-9, 4=10+, 9=Unk)*/
2224              RF_PHYS_JOBWALK         /*Number of years walked or biked to work most days (0=None,
2224! 1=<1, 2=1-2, 3=3-5, 4=6-9, 5=10+, 9=Unk)*/
2225              RF_PHYS_TV              /*Hours spent watching tv/videos during typical 24 hour period
2225! in past 12 months (0=None, 1=<1, 2=1-2, 3=3-4, 4=5-6, 5=7-8, 6=9+, 9=Unk)*/
2226              RF_PHYS_SLEEP           /*Hours spent sleeping at night during typical 24 hour period
2226! in past 12 months (0=<5, 1=5-6, 2=7-8, 3=9+, 9=Unk)*/
2227              RF_PHYS_NAP             /*Hours spent napping during typical 24 hour period in past 12
2227! months (0=None, 1=<1, 2=1-2, 3=3-4, 4=5-6, 9=Unk)*/
2228              RF_PHYS_SIT             /*Hours spent sitting during typical 24 hour period in past 12
2228! months (0=<3, 1=3-4, 2=5-6, 3=7-8, 4=9+, 9=Unk)*/
2229
2230              /** NSAID variables **/
2231              rf_Q10_1                /* During the past 12 mo, did you take generic aspirin, bayer,
2231! bufferin, anacin, ecotrin, or excedrin? */
2232              rf_Q10_2                /* How often? */
2233              rf_Q11_1                /* During the past 12 mo, did you take generic ibuprofen,
2233! advil, nuprin, motrin, aleve, etc */
2234              rf_Q11_2                /* How often? */
2235              RF_ABNET_ASPIRIN        /*Ever take Aspirin during the past 12 months?*/
2236              RF_ABNET_CAT_ASPIRIN    /*Frequency of Aspirin use during the past 12 months*/
2237              RF_ABNET_IBUPROFEN      /*Ever take Ibuprofen during the past 12 months?*/
2238              RF_ABNET_CAT_IBUPROFEN  /*Frequency of Ibuprofen use during the past 12 months*/
2239  ;
2240  run;

NOTE: There were 334905 observations read from the data set ANCHOVY.ROUT25MAR16.
NOTE: There were 334905 observations read from the data set ANCHOVY.REXP23FEB16.
NOTE: The data set WORK.RANALYSIS has 334905 observations and 89 variables.
NOTE: DATA statement used (Total process time):
      real time           1:22.97
      cpu time            1:22.89


2241
2242  ** merge the melan_r dataset with special UVR dataset;
2243  data ranalysis;
2244      merge ranalysis (in=frodo) conv.uv_pub1 ;
2245      by westatid;
2246      if frodo;
2247  run;

NOTE: There were 334905 observations read from the data set WORK.RANALYSIS.
NOTE: There were 566398 observations read from the data set CONV.UV_PUB1.
NOTE: The data set WORK.RANALYSIS has 334905 observations and 90 variables.
NOTE: DATA statement used (Total process time):
      real time           0.43 seconds
      cpu time            0.42 seconds


2248
2249  /* check point for merging the exposure and outcome data */
2250  ** copy and save the ranalysis dataset to the converted folder;
2251  proc copy noclone in=Work out=conv;
2252      select ranalysis;
2253  run;

NOTE: Copying WORK.RANALYSIS to CONV.RANALYSIS (memtype=DATA).
NOTE: System Options for BUFSIZE and REUSE were used at user's request.
NOTE: Libname and/or system options for compress, pointobs, data representation and encoding attributes
      were used at user's request.
NOTE: There were 334905 observations read from the data set WORK.RANALYSIS.
NOTE: The data set CONV.RANALYSIS has 334905 observations and 90 variables.
NOTE: PROCEDURE COPY used (Total process time):
      real time           0.21 seconds
      cpu time            0.21 seconds


2254
2255  /******************************************************************************************/
2256  /* start2 */
2257  /* create melanoma outcome variables
2258  /* exit dates, person years
2259  /* use exclusions macro, exclude non-whites, exclude LE zero personyears
2260  /******************************************************************************************/
2261  ods _all_ close; ods html;
NOTE: Writing HTML Body file: sashtml6.htm
2262  %include 'C:\REB\NSAIDS melanoma AARP\Analysis\format.risk.w.sas';
NOTE: Format SEXFMT is already on the library.
NOTE: Format SEXFMT has been output.
NOTE: Format MELANFMT is already on the library.
NOTE: Format MELANFMT has been output.
NOTE: Format MELANOMAFMT is already on the library.
NOTE: Format MELANOMAFMT has been output.
NOTE: Format BIRTHCOHORTFMT is already on the library.
NOTE: Format BIRTHCOHORTFMT has been output.
NOTE: Format NSAIDBIFMT is already on the library.
NOTE: Format NSAIDBIFMT has been output.
NOTE: Format NSAIDFMT is already on the library.
NOTE: Format NSAIDFMT has been output.
NOTE: Format AGECATFMT is already on the library.
NOTE: Format AGECATFMT has been output.
NOTE: Format UVRQFMT is already on the library.
NOTE: Format UVRQFMT has been output.
NOTE: Format ALCOHOLFMT is already on the library.
NOTE: Format ALCOHOLFMT has been output.
NOTE: Format PHYSICFMT is already on the library.
NOTE: Format PHYSICFMT has been output.
NOTE: Format PHYSICCFMT is already on the library.
NOTE: Format PHYSICCFMT has been output.
NOTE: Format $QP12BFMT is already on the library.
NOTE: Format $QP12BFMT has been output.
NOTE: Format TVFMT is already on the library.
NOTE: Format TVFMT has been output.
NOTE: Format RFTVFMT is already on the library.
NOTE: Format RFTVFMT has been output.
NOTE: Format NAPFMT is already on the library.
NOTE: Format NAPFMT has been output.
NOTE: Format RFNAPFMT is already on the library.
NOTE: Format RFNAPFMT has been output.
NOTE: Format MARRIAGEFMT is already on the library.
NOTE: Format MARRIAGEFMT has been output.
NOTE: Format RFMARRIAGEFMT is already on the library.
NOTE: Format RFMARRIAGEFMT has been output.
NOTE: Format EDUCFMT is already on the library.
NOTE: Format EDUCFMT has been output.
NOTE: Format RFEDUCFMT is already on the library.
NOTE: Format RFEDUCFMT has been output.
NOTE: Format HEARTFMT is already on the library.
NOTE: Format HEARTFMT has been output.
NOTE: Format UTILIZERWFMT is already on the library.
NOTE: Format UTILIZERWFMT has been output.
NOTE: Format $RFQ44FMT is already on the library.
NOTE: Format $RFQ44FMT has been output.
NOTE: Format UTILIZERMFMT is already on the library.
NOTE: Format UTILIZERMFMT has been output.
NOTE: Format $RFQ15AFMT is already on the library.
NOTE: Format $RFQ15AFMT has been output.
NOTE: Format $RFQ15BFMT is already on the library.
NOTE: Format $RFQ15BFMT has been output.
NOTE: Format $RFQ15CFMT is already on the library.
NOTE: Format $RFQ15CFMT has been output.
NOTE: Format $RFQ15DFMT is already on the library.
NOTE: Format $RFQ15DFMT has been output.
NOTE: Format $RFQ15EFMT is already on the library.
NOTE: Format $RFQ15EFMT has been output.
NOTE: Format BMIFMT is already on the library.
NOTE: Format BMIFMT has been output.
NOTE: Format SMOKEFORMERFMT is already on the library.
NOTE: Format SMOKEFORMERFMT has been output.
NOTE: Format SMOKEQUITFMT is already on the library.
NOTE: Format SMOKEQUITFMT has been output.
NOTE: Format SMOKEDOSEFMT is already on the library.
NOTE: Format SMOKEDOSEFMT has been output.
NOTE: Format SMOKEQUITDOSEFMT is already on the library.
NOTE: Format SMOKEQUITDOSEFMT has been output.
NOTE: Format COFFEEFMT is already on the library.
NOTE: Format COFFEEFMT has been output.
NOTE: Format RFPHYSICFMT is already on the library.
NOTE: Format RFPHYSICFMT has been output.
NOTE: Format RFPHYSICCFMT is already on the library.
NOTE: Format RFPHYSICCFMT has been output.
NOTE: Format HTENSIONFMT is already on the library.
NOTE: Format HTENSIONFMT has been output.
NOTE: Format RF_ABNET_ASPIRINFMT is already on the library.
NOTE: Format RF_ABNET_ASPIRINFMT has been output.
NOTE: Format RF_ABNET_IBUPROFENFMT is already on the library.
NOTE: Format RF_ABNET_IBUPROFENFMT has been output.
NOTE: Format RF_ABNET_CAT_ASPIRINFMT is already on the library.
NOTE: Format RF_ABNET_CAT_ASPIRINFMT has been output.
NOTE: Format RF_ABNET_CAT_IBUPROFENFMT is already on the library.
NOTE: Format RF_ABNET_CAT_IBUPROFENFMT has been output.
NOTE: Format ASPIRIN_COLLAPSEFMT is already on the library.
NOTE: Format ASPIRIN_COLLAPSEFMT has been output.
NOTE: Format IBU_COLLAPSEFMT is already on the library.
NOTE: Format IBU_COLLAPSEFMT has been output.
NOTE: Format NSAIDFMT is already on the library.
NOTE: Format NSAIDFMT has been output.
NOTE: Format NSAIDBIFMT is already on the library.
NOTE: Format NSAIDBIFMT has been output.
NOTE: Format $RFQ101FMT is already on the library.
NOTE: Format $RFQ101FMT has been output.
NOTE: Format $RFQ102FMT is already on the library.
NOTE: Format $RFQ102FMT has been output.
NOTE: Format SHEBLASPFFMT is already on the library.
NOTE: Format SHEBLASPFFMT has been output.
NOTE: Format SHEBLASPUFMT is already on the library.
NOTE: Format SHEBLASPUFMT has been output.
NOTE: Format SHEBLTYPEFMT is already on the library.
NOTE: Format SHEBLTYPEFMT has been output.
NOTE: Format EXCLUDEFMT is already on the library.
NOTE: Format EXCLUDEFMT has been output.

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.05 seconds
      cpu time            0.04 seconds


2500  libname conv 'C:\REB\NSAIDS melanoma AARP\Data\converted';
NOTE: Libref CONV was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\REB\NSAIDS melanoma AARP\Data\converted
2501  ** uses the pre-created analysis_use from above checkpoint;
2502  data melan_r; ** name the output of the first primary analysis include to melan_r;
2503      set conv.ranalysis;
2504      ****** Define melanoma - pulled from allcancer-coffee analysis ******;
2505      ** create the melanoma case variable from the cancer ICD-O-3 and SEER coding of 25010;
2506      ** contains both melanoma subtypes;
2507      melanoma_c = .;
2508      * in situ melanoma =1;
2509      if cancer_behv='2' and cancer_seergroup = 18 and cancer_siterec3=25010
2510          then melanoma_c = 1;
2511      * malignant melanoma =2;
2512      else if cancer_behv='3' and cancer_seergroup = 18 and cancer_siterec3=25010
2513          then melanoma_c = 2;
2514      else melanoma_c = 0;
2515
2516      melanoma_ins=0;
2517      if      melanoma_c=1        then melanoma_ins=1;
2518      melanoma_mal=0;
2519      if      melanoma_c=2        then melanoma_mal=1;
2520
2521      ****  Create exit date, exit age, and person years for First Primary Cancer;
2522      ** with first primary cancer as skin cancer;
2523      * Chooses the earliest of 4 possible exit dates for skin cancer;
2524      exit_dt = min(mdy(12,31,2006), cancer_dxdt, dod, raadate);
2525      exit_age = round(((exit_dt-f_dob)/365.25),.001);
2526      personyrs = round(((exit_dt-entry_dt)/365.25),.001);
2527      rf_personyrs = round(((exit_dt-rf_entry_dt)/365.25),.001);
2528      yob=year(F_DOB);
2529
2530      format exit_dt entry_dt rf_entry_dt f_dob dod cancer_dxdt raadate Date9.;
2531  run;

NOTE: There were 334905 observations read from the data set CONV.RANALYSIS.
NOTE: The data set WORK.MELAN_R has 334905 observations and 98 variables.
NOTE: DATA statement used (Total process time):
      real time           0.40 seconds
      cpu time            0.40 seconds


2532
2533
2534  **** Exclusions risk macro;
2535  *Start here to run macro to get exclusion;
2536  ods _all_ close; ods html;
NOTE: Writing HTML Body file: sashtml7.htm
2537  %include 'C:\REB\NSAIDS melanoma AARP\Analysis\anchovy\exclusions.first.primary.risk.macro.sas';
2758
2759  **** Use the exclusion macro to make "standard" exclusions and get counts of excluded subjects;
2760  title 'exclusion macro, rfq';
2761  %exclude(data               = melan_r,
2762           ex_proxy           = 1,
2763           ex_rf_proxy        = 1,
2764           ex_sex             = ,
2765           ex_selfother       = 1,
2766           ex_rf_selfbreast   = 1,
2767           ex_rf_selfovary    = 1,
2768           ex_health          = ,
2769           ex_prevcan         = 1,
2770           ex_deathcan        = 1);
NOTE: Format EXFLAGF is already on the library.
NOTE: Format EXFLAGF has been output.

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds



NOTE: There were 334905 observations read from the data set WORK.MELAN_R.
NOTE: The data set WORK.MELAN_R has 304416 observations and 99 variables.
NOTE: The data set WORK.EXCLUSIONS has 30489 observations and 99 variables.
NOTE: DATA statement used (Total process time):
      real time           0.38 seconds
      cpu time            0.37 seconds



NOTE: There were 30489 observations read from the data set WORK.EXCLUSIONS.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.11 seconds
      cpu time            0.03 seconds



NOTE: There were 30489 observations read from the data set WORK.EXCLUSIONS.
NOTE: The data set WORK.EXCLUSIONS has 30489 observations and 99 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.06 seconds
      cpu time            0.06 seconds



NOTE: No observations were selected from data set WORK.EXCLUSIONS.
NOTE: There were 0 observations read from the data set WORK.EXCLUSIONS.
      WHERE ex_flag=14;
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds


2771
2772  /***************************************************************************************/
2773  /*   Exclude if not 'non-Hispanic White'                                               */
2774  /***************************************************************************************/
2775  title 'exclusion non non-Hispanic whites';

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds


2776  data melan_r;
2777      set melan_r;
2778      excl_1_race=0;
2779      if racem NE 1 then excl_1_race=1;
2780  run;

NOTE: There were 304416 observations read from the data set WORK.MELAN_R.
NOTE: The data set WORK.MELAN_R has 304416 observations and 100 variables.
NOTE: DATA statement used (Total process time):
      real time           0.25 seconds
      cpu time            0.26 seconds


2781  proc freq data= melan_r;
2782      title 'excl_1_race: exclude non-whites';
2783      tables  excl_1_race
2784              excl_1_race*melanoma_c /missing;
2785  run;

NOTE: There were 304416 observations read from the data set WORK.MELAN_R.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.18 seconds
      cpu time            0.11 seconds


2786  data melan_r;
2787      set melan_r;
2788      where excl_1_race=0;
2789  run;

NOTE: There were 281285 observations read from the data set WORK.MELAN_R.
      WHERE excl_1_race=0;
NOTE: The data set WORK.MELAN_R has 281285 observations and 100 variables.
NOTE: DATA statement used (Total process time):
      real time           0.27 seconds
      cpu time            0.26 seconds


2790
2791  /***************************************************************************************/
2792  /*   Exclude if person-years <= 0                                                       */
2793  /***************************************************************************************/
2794  title 'exclusion person years <=0';
2795  data melan_r;
2796      set melan_r;
2797      excl_2_pyr=0;
2798      if rf_personyrs <= 0 then excl_2_pyr=1;
2799  run;

NOTE: There were 281285 observations read from the data set WORK.MELAN_R.
NOTE: The data set WORK.MELAN_R has 281285 observations and 101 variables.
NOTE: DATA statement used (Total process time):
      real time           0.24 seconds
      cpu time            0.24 seconds


2800  proc freq data= melan_r ;
2801      title 'excl_2_pyr: exclude 0 or negative person years';
2802      tables  excl_2_pyr
2803              excl_2_pyr*melanoma_c /missing;
2804  run;

NOTE: There were 281285 observations read from the data set WORK.MELAN_R.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.47 seconds
      cpu time            0.11 seconds


2805  data melan_r;
2806      set melan_r;
2807      where excl_2_pyr=0;
2808  run;

NOTE: There were 281257 observations read from the data set WORK.MELAN_R.
      WHERE excl_2_pyr=0;
NOTE: The data set WORK.MELAN_R has 281257 observations and 101 variables.
NOTE: DATA statement used (Total process time):
      real time           0.29 seconds
      cpu time            0.29 seconds


2809
2810  proc freq data= melan_r;
2811      title 'RFQ counts';
2812      tables melanoma_c*sex /missing;
2813  run;

NOTE: There were 281257 observations read from the data set WORK.MELAN_R.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.28 seconds
      cpu time            0.09 seconds


2814  title;
2815
2816  /******************************************************************************************/
2817  ** find the cutoffs for the percentiles of UVR- exposure_jul_78_05 ;
2818  /*proc univariate data=conv.melan_r;
2819      var exposure_jul_78_05;
2820      output  out=blu
2821              pctlpts= 0 20 40 60 80 100
2822              pctlpre=p;
2823  run;
2824  proc print data=blu;
2825      title 'UVR exposure percentiles';
2826  run; */
2827
2828      ** need to change the exposure percentiles after exclusion change;
2829      ** uvr exposure;
2830      ** Quartiles: 176.095 <= Q1 <= 186.255 < Q2 <= 236.805 < Q3 <= 253.731 < Q4 <= 289.463;
2831  /******************************************************************************************/
2832  /** start3
2833  /** create the UVR, and confounder variables by quartile/categories
2834  /** for both baseline and riskfactor questionnaire variables
2835  /** cat=categorical **/
2836  /** reordered 20160119TUE **/
2837  /******************************************************************************************/
2838  data melan_use;
2839      set melan_r;
2840
2841      ** UVR TOMS quartile;
2842      UVRQ=9;
2843      if      176.000 < exposure_jul_78_05 <= 186.255     then UVRQ=1; /* Q1 lowest*/
2844      else if 186.255 < exposure_jul_78_05 <= 236.805     then UVRQ=2; /* Q2 */
2845      else if 236.805 < exposure_jul_78_05 <= 253.731     then UVRQ=3; /* Q3 */
2846      else if 253.731 < exposure_jul_78_05 <  290         then UVRQ=4; /* Q4 highest */
2847
2848      /* education attained */
2849      educm_comb=9;
2850      if          EDUCM in (1,2)                  then educm_comb=1; *high school graduate*;
2851      else if     EDUCM=3                         then educm_comb=2; *post high school*;
2852      else if     EDUCM=4                         then educm_comb=3; *some college*;
2853      else if     EDUCM=5                         then educm_comb=4; *college graduate*;
2854
2855      /* alcohol consumption */
2856      ** edited to weekly, 20151223WED ;
2857      alcohol_comb=9;
2858      if      mped_a_bev=0                        then alcohol_comb=0; /* none */
2859      else if 0<mped_a_bev<0.142857               then alcohol_comb=1; /* <=1, <1 drink per week */
2860      else if 0.142857<=mped_a_bev<1              then alcohol_comb=2; /* >1-<=2 drinks, 1-6 per week
2860!  */
2861      else if 1<=mped_a_bev                       then alcohol_comb=3; /* 2< drinks, 7+ per week */
2862
2863      ** bmi four categories;
2864      bmi_c=9;
2865      if            bmi_cur<18.5                  then bmi_c=1; /* <18.5, underweight */
2866      else if 18.5<=bmi_cur<25                    then bmi_c=2; /* 18.5-24.9, normal */
2867      else if 25  <=bmi_cur<30                    then bmi_c=3; /* 25-29.9, overweight */
2868      else if 30  <=bmi_cur                       then bmi_c=4; /* >=30, obese */
2869
2870      ** physical exercise cat;
2871      physic_c=9;
2872      if      physic in (0,1)                     then physic_c=0; /* rarely */
2873      else if physic=2                            then physic_c=1; /* 1-3 per month */
2874      else if physic=3                            then physic_c=2; /* 1-2 per week */
2875      else if physic=4                            then physic_c=3; /* 3-4 per week */
2876      else if physic=5                            then physic_c=4; /* 5+ per week */
2877
2878      ** physical exercise between ages 15 and 18 cat;
2879      physic_1518_c=9;
2880      if      physic_1518 in (0,1)                then physic_1518_c=0; /* rarely */
2881      else if physic_1518=2                       then physic_1518_c=1; /* 1-3 per month */
2882      else if physic_1518=3                       then physic_1518_c=2; /* 1-2 per week */
2883      else if physic_1518=4                       then physic_1518_c=3; /* 3-4 per week */
2884      else if physic_1518=5                       then physic_1518_c=4; /* 5+ per week */
2885
2886      ** coffee drinking;
2887      coffee_c=9;
2888      if      qp12b='0'                           then coffee_c=0;    /* none */
2889      else if qp12b in ('1','2','3','4','5','6')  then coffee_c=1;    /* <=1/day */
2890      else if qp12b='7'                           then coffee_c=2;    /* 2-3/day */
2891      else if qp12b in ('8','9')                  then coffee_c=3;    /* >=4/day */
2892      else if qp12b in ('E','M')                  then coffee_c=9;    /* missing */
2893
2894      /* marriage status */
2895      marriage_comb=9;
2896      if          MARRIAGE=1                      then marriage_comb=1; *married or living as married
2896!  *;
2897      else if     MARRIAGE=2                      then marriage_comb=2; *widowed*;
2898      else if     MARRIAGE in (3,4)               then marriage_comb=3; *divorced or separated*;
2899      else if     MARRIAGE=5                      then marriage_comb=4; *never married*;
2900
2901      ***********************************************************************************************
2901! ***********;
2902      ** new NSAID variables below **;
2903
2904      ** Shebl NSAID coding 20151217THU;
2905      ** http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0114633 ;
2906
2907      ** nsaid type;
2908      shebl_type=9;
2909      if      rf_Q10_1='0' and rf_Q11_1='0'                   then shebl_type=1; /* neither nsaid use
2909!  */
2910      else if rf_Q10_1='1' and rf_Q11_1='0'                   then shebl_type=2; /* apsirin use only
2910! */
2911      else if rf_Q10_1='0' and rf_Q11_1='1'                   then shebl_type=3; /* nonaspirin use
2911! only */
2912      else if rf_Q10_1='1' and rf_Q11_1='1'                   then shebl_type=4; /* both aspirin and
2912! nonaspirin use */
2913      ** shebl type main effect;
2914      shebl_type_me=shebl_type;
2915      if shebl_type_me=9                                      then shebl_type_me=.; /* unknown to
2915! missing */
2916
2917      ** aspirin use frequency;
2918      shebl_asp_f=9;
2919      if      rf_Q10_1='1' and rf_Q10_2 in ('0','1')          then shebl_asp_f=1; /* monthly, <=3 per
2919!  month */
2920      else if rf_Q10_1='1' and rf_Q10_2 in ('2','3','4')      then shebl_asp_f=2; /* weekly, >=1 per
2920! week */
2921      else if rf_Q10_1='1' and rf_Q10_2 in ('5','6')          then shebl_asp_f=3; /* daily, >=1 per
2921! day */
2922      else if rf_Q10_1='0'                                    then shebl_asp_f=0; /* no aspirin */
2923
2924      **aspirin use main effect;
2925      shebl_asp_me=shebl_asp_f;
2926      if shebl_asp_me=9                                       then shebl_asp_me=.; /* unknown to
2926! missing */
2927
2928      ** nonaspirin use frequency;
2929      shebl_non_f=9;
2930      if      rf_Q11_1='1' and rf_Q11_2 in ('0','1')          then shebl_non_f=1; /* monthly, <=3 per
2930!  month */
2931      else if rf_Q11_1='1' and rf_Q11_2 in ('2','3','4')      then shebl_non_f=2; /* weekly, >=1 per
2931! week */
2932      else if rf_Q11_1='1' and rf_Q11_2 in ('5','6')          then shebl_non_f=3; /* daily, >=1 per
2932! day */
2933      else if rf_Q11_1='0'                                    then shebl_non_f=0; /* no nonaspirin */
2934
2935      ** nonaspirin use main effect;
2936      shebl_non_me=shebl_non_f;
2937      if shebl_non_me=9                                       then shebl_non_me=.; /* unknown to
2937! missing */
2938
2939      ** END new NSAIDs variables **;
2940      ***********************************************************************************************
2940! *************************;
2941
2942      /* Television watched */
2943      TV_comb=9;
2944      if          RF_PHYS_TV in (0,1)             then TV_comb=1; *none/<1 hr/day *;
2945      else if     RF_PHYS_TV=2                    then TV_comb=2; *1-2 hours/day *;
2946      else if     RF_PHYS_TV=3                    then TV_comb=3; *3-4 hours/day *;
2947      else if     RF_PHYS_TV in (4,5,6)           then TV_comb=4; *>=5 hours/day *;
2948
2949      /* napping duration */
2950      nap_comb=9;
2951      if          RF_PHYS_NAP=0                   then nap_comb=0; *never naps *;
2952      else if     RF_PHYS_NAP=1                   then nap_comb=1; *<1 hour/day *;
2953      else if     RF_PHYS_NAP in (2,3,4)          then nap_comb=2; *naps >=1 hour/day *;
2954
2955      ** hypertension as told by doctor?;
2956      htension=9;
2957      if      rf_Q47_1='1'                        then htension=1; /* yes to hypertension */
2958      else if rf_Q47_1='0'                        then htension=0; /* no to hypertension*/
2959
2960      /* hospital utilization-colonoscopy, sigmoidoscopy, proctoscopy in past 3 years */
2961      utilizer_m=9;
2962      if rf_Q15E='1'                              then utilizer_m=0; /* yes, utilized */
2963      else if rf_Q15A='1'                         then utilizer_m=1; /* did not utilize */
2964      else if rf_Q15B='1'                         then utilizer_m=1; /* did not utilize */
2965      else if rf_Q15C='1'                         then utilizer_m=1; /* did not utilize */
2966      else if rf_Q15D='1'                         then utilizer_m=1; /* did not utilize */
2967
2968      /* hospital utilization-mammograms */
2969      utilizer_w=9;
2970      if rf_Q44='1' | rf_Q44='2'                  then utilizer_w=1; /* yes once and more mammograms
2970! in last 3 years*/
2971      else if rf_Q44='0'                          then utilizer_w=0;  /* no mamograms in last 3 years
2971!  */
2972
2973      ** RF entry age quartiles;
2974      agecat=.;
2975      if      51 <= rf_entry_age < 60     then agecat=1; /* 51-59 */
2976      else if 60 <= rf_entry_age < 65     then agecat=2; /* 60-64 */
2977      else if 65 <= rf_entry_age          then agecat=3; /* 65+ */
2978
2979      /**********************************************************************************************
2979! ***/
2980
2981      ** 5 yr year of birth categories;
2982      bc_cat=.;
2983      if      1925 <= yob < 1930          then bc_cat=1; /* 1925-1929 */
2984      else if 1930 <= yob < 1935          then bc_cat=2; /* 1930-1934 */
2985      else if 1935 <= yob < 1940          then bc_cat=3; /* 1935-1939 */
2986      else if 1940 <= yob <= 1945         then bc_cat=4; /* 1940-1945 */
2987
2988      ** (rf) physical exercise how often participate mod-vig activites in past 10 years;
2989      rf_physic_c=9;
2990      if      rf_phys_modvig_curr in (0,1)        then rf_physic_c=0; /* none-rarely */
2991      else if rf_phys_modvig_curr=2               then rf_physic_c=1; /* <1 hr/week */
2992      else if rf_phys_modvig_curr=3               then rf_physic_c=2; /* 1-3 hr/week */
2993      else if rf_phys_modvig_curr=4               then rf_physic_c=3; /* 4-7 hr/week */
2994      else if rf_phys_modvig_curr=5               then rf_physic_c=4; /* >7 hr/week */
2995
2996      /**********************************************************************************************
2996! ***/
2997  run;

NOTE: There were 281257 observations read from the data set WORK.MELAN_R.
NOTE: The data set WORK.MELAN_USE has 281257 observations and 123 variables.
NOTE: DATA statement used (Total process time):
      real time           0.52 seconds
      cpu time            0.48 seconds


2998
2999  ** add labels;
3000  proc datasets library=work;
3001      title;
3002      modify melan_use;
3003
3004      ** set variable labels;
3005      label   /* melanoma outcomes */
3006              melanoma_c = "Melanoma indicator by type"
3007              melanoma_ins= "Melanoma in situ indicator"
3008              melanoma_mal= "Malignant melanoma indicator"
3009
3010              /* for baseline */
3011              uvrq = "TOMS UVR measures in quartiles"
3012              /*educ_c = "education level"*/
3013              physic_c = "level of physical activity"
3014              bmi_c = "bmi, rough"
3015              physic_c = "physical activity in past 12 months"
3016              physic_1518_c = "physical activity at ages 15-18"
3017
3018              smoke_former ="Smoking Status"
3019              smoke_quit = 'Quit smoking status'
3020              smoke_dose = 'Smoking dose'
3021              smoke_quit_dose = 'Smoking status and dose combined'
3022              coffee_c = 'Coffee drinking'
3023              alcohol_comb = 'Total alchohol per day including food sources'
3024
3025              /* for riskfactor */
3026              rf_Q10_1="RFQ aspirin indicator"
3027              rf_Q10_2="RFQ aspirin freq"
3028              rf_Q11_1="RRQ non-aspirin indicator"
3029              rf_Q11_2="RFQ non-aspirin freq"
3030              rf_Q47_1="RFQ hypertension"
3031              htension="Hypertension"
3032              rf_physic_c = "Times engaged in moderate-vigorous physical activity"
3033              rf_1d_cancer = "Family History of Cancer"
3034              shebl_asp_f="Shebl coded aspirin freq"
3035              shebl_non_f="Shebl coded non-aspirin freq"
3036              shebl_type="Shebl coded NSAID use type"
3037      ;
3038      ** set variable value labels;
3039      format  /* for outcomes */
3040              melanoma_c melanfmt.
3041              bmi_c bmifmt. agecat agecatfmt.
3042              smoke_quit smokequitfmt. smoke_dose smokedosefmt.
3043              smoke_quit_dose smokequitdosefmt.
3044              coffee_c coffeefmt.
3045              sex sexfmt.
3046              UVRQ uvrqfmt.
3047              alcohol_comb alcoholfmt.
3048              smoke_former smokeformerfmt.
3049              physic_c physic_1518_c physicfmt.
3050              physic physic_1518 physiccfmt.
3051              coffee_c coffeefmt. qp12b $qp12bfmt.
3052              tv_comb tvfmt. RF_PHYS_TV rftvfmt.
3053              nap_comb napfmt. RF_PHYS_NAP rfnapfmt.
3054              marriage_comb marriagefmt. MARRIAGE rfmarriagefmt.
3055              educm_comb educfmt. EDUCM rfeducfmt.
3056              heart heartfmt.
3057              utilizer_w utilizerwfmt. rf_Q44 $rfq44fmt.
3058              utilizer_m utilizermfmt.
3059              rf_Q15A $rfq15afmt. rf_Q15B $rfq15bfmt. rf_Q15C $rfq15cfmt. rf_Q15D $rfq15dfmt. rf_Q15E
3059!  $rfq15efmt.
3060              htension htensionfmt.
3061              rf_abnet_aspirin rf_abnet_aspirinfmt.
3062              rf_abnet_ibuprofen rf_abnet_ibuprofenfmt.
3063              rf_abnet_cat_aspirin rf_abnet_cat_aspirinfmt.
3064              rf_abnet_cat_ibuprofen rf_abnet_cat_ibuprofenfmt.
3065              rf_Q10_1 rf_Q11_1 $rfq101fmt. rf_Q10_2 rf_Q11_2 $rfq102fmt.
3066              shebl_asp_f shebl_non_f shebl_asp_me shebl_non_me sheblaspffmt.
3067              shebl_type shebl_type_me shebltypefmt.
3068              RF_PHYS_MODVIG_CURR rfphysiccfmt.
3069      ;
3070  run;

NOTE: MODIFY was successful for WORK.MELAN_USE.DATA.
3071

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.65 seconds
      cpu time            0.06 seconds


3072  proc copy noclone in=Work out=conv;
3073      select melan_use;
3074  run;

NOTE: Copying WORK.MELAN_USE to CONV.MELAN_USE (memtype=DATA).
NOTE: System Options for BUFSIZE and REUSE were used at user's request.
NOTE: Libname and/or system options for compress, pointobs, data representation and encoding attributes
      were used at user's request.
NOTE: There were 281257 observations read from the data set WORK.MELAN_USE.
NOTE: The data set CONV.MELAN_USE has 281257 observations and 123 variables.
NOTE: PROCEDURE COPY used (Total process time):
      real time           0.35 seconds
      cpu time            0.34 seconds


